import{u as S,r as l,j as e,t as r,o as T,s as E}from"./index-ClTdhUSR.js";import{s as k,v as C}from"./otpService-D1Q3AacJ.js";function z(){const p=S(),[y,f]=l.useState("form"),[s,j]=l.useState({name:"",phone:"",email:"",specialization:"",location:"",licenseNumber:"",password:""}),[d,x]=l.useState(""),[u,m]=l.useState(!1),[b,t]=l.useState(""),[h,c]=l.useState(""),o=n=>{const{name:a,value:g}=n.target;j(i=>({...i,[a]:g}))},N=async n=>{if(n.preventDefault(),!s.name.trim()){t("Name is required");return}if(!s.phone.trim()){t("Phone number is required");return}if(!s.specialization.trim()){t("Specialization is required");return}if(!s.licenseNumber.trim()){t("License number is required");return}if(!s.password.trim()){t("Password is required");return}if(s.password.length<6){t("Password must be at least 6 characters");return}m(!0),t(""),c("");try{const a=k(s.phone,"signup");a.success?(f("otp"),c("OTP sent successfully!")):t(a.error||"Failed to send OTP")}catch(a){t("An error occurred while sending OTP"),console.error("OTP send error:",a)}finally{m(!1)}},v=async n=>{if(n.preventDefault(),!d.trim()){t("Please enter OTP");return}if(d.length!==6){t("OTP must be 6 digits");return}m(!0),t(""),c("");try{const a=C(s.phone,d,"signup");if(a.success){const g={name:s.name.trim(),phone:s.phone.trim(),email:s.email.trim(),specialization:s.specialization.trim(),location:s.location.trim(),licenseNumber:s.licenseNumber.trim(),password:s.password,role:"doctor"},i=T(g);if(i.success){const O={current:{role:"doctor",id:i.user.id,name:i.user.name,loggedAt:new Date().toISOString()}};E(O),c("Account created successfully!"),setTimeout(()=>{p("/doctor/dashboard")},1500)}else t(i.error||"Failed to create account")}else t(a.error||"Invalid OTP")}catch(a){t("An error occurred while verifying OTP"),console.error("OTP verify error:",a)}finally{m(!1)}},w=()=>{f("form"),x(""),t(""),c("")},P=["General Medicine","Cardiology","Dermatology","Pediatrics","Gynecology","Orthopedics","Neurology","Psychiatry","Ophthalmology","ENT","Radiology","Anesthesiology","Emergency Medicine","Internal Medicine","Surgery"];return e.jsxs("div",{className:"min-h-screen flex flex-col bg-gradient-to-b from-green-50 to-green-100 font-sans",children:[e.jsx("main",{className:"flex-grow flex items-center justify-center px-4",children:e.jsxs("div",{className:"bg-white p-8 rounded-2xl shadow-xl w-full max-w-md border border-green-100",children:[h&&e.jsx("div",{className:"mb-4 p-3 bg-green-50 border border-green-200 rounded-md",children:e.jsx("p",{className:"text-sm text-green-800",children:h})}),b&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md",children:e.jsx("p",{className:"text-sm text-red-800",children:b})}),y==="form"?e.jsxs("form",{onSubmit:N,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r("Full Name")," *"]}),e.jsx("input",{type:"text",name:"name",value:s.name,onChange:o,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:r("Enter your full name")})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r("Mobile Number")," *"]}),e.jsx("input",{type:"tel",name:"phone",value:s.phone,onChange:o,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:r("Enter mobile number")})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r("Email")," (Optional)"]}),e.jsx("input",{type:"email",name:"email",value:s.email,onChange:o,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:r("Enter email address")})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r("Specialization")," *"]}),e.jsxs("select",{name:"specialization",value:s.specialization,onChange:o,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:r("Select specialization")}),P.map(n=>e.jsx("option",{value:n,children:n},n))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r("License Number")," *"]}),e.jsx("input",{type:"text",name:"licenseNumber",value:s.licenseNumber,onChange:o,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:r("Enter medical license number")})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r("Location")," (Optional)"]}),e.jsx("input",{type:"text",name:"location",value:s.location,onChange:o,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:r("Enter your location")})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r("Password")," *"]}),e.jsx("input",{type:"password",name:"password",value:s.password,onChange:o,required:!0,minLength:"6",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:r("Enter password (min 6 characters)")})]}),e.jsx("button",{type:"submit",disabled:u,className:"w-full bg-green-600 text-white py-2 rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:u?r("Sending OTP..."):r("Send OTP")})]}):e.jsxs("form",{onSubmit:v,className:"space-y-4",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsxs("p",{className:"text-gray-600",children:[r("OTP sent to")," ",s.phone]}),e.jsx("p",{className:"text-sm text-gray-500",children:r("Please enter the 6-digit OTP")})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r("Enter OTP")," *"]}),e.jsx("input",{type:"text",value:d,onChange:n=>x(n.target.value.replace(/\D/g,"").slice(0,6)),required:!0,maxLength:"6",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent text-center text-lg tracking-widest",placeholder:"000000"})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{type:"button",onClick:w,className:"flex-1 bg-gray-300 text-gray-700 py-2 rounded-lg hover:bg-gray-400 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-colors",children:r("Back")}),e.jsx("button",{type:"submit",disabled:u,className:"flex-1 bg-green-600 text-white py-2 rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:u?r("Verifying..."):r("Verify OTP")})]})]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-6 text-center",children:[r("Already have an account?")," ",e.jsx("button",{onClick:()=>p("/doctor/login"),className:"text-green-700 font-semibold hover:underline",children:r("Login")})]})]})}),e.jsxs("footer",{className:"bg-green-700 text-white py-4 text-center text-sm mt-8 shadow-inner",children:["Â© ",new Date().getFullYear()," ",r("E-Sannidhi")," | ",r("Government of India Initiative")]})]})}export{z as default};
