import{r as i,p as D,j as e,t as s,c as L,q as E,u as R,m as z,v as W,w as I,x as H,y as O}from"./index-ClTdhUSR.js";import{J as T,M as B}from"./MessageVideoSection-D20M9Bnv.js";function F({onAttendPatient:h}){const[r,n]=i.useState([]),[m,d]=i.useState(!1),[p,j]=i.useState("");i.useEffect(()=>{o();const a=setInterval(o,3e4);return()=>clearInterval(a)},[]);const o=()=>{try{const a=D();n(a)}catch(a){console.error("Error loading waiting visits:",a),j("Failed to load waiting visits")}},b=a=>{h&&h(a)},c=a=>{if(!a)return s("Unknown");const g=new Date(a),x=Math.floor((new Date-g)/(1e3*60));return x<1?s("Just now"):x<60?`${x} ${s("min ago")}`:x<1440?`${Math.floor(x/60)} ${s("hr ago")}`:g.toLocaleDateString()},f=a=>{switch(a){case"high":return"bg-red-100 text-red-800";case"medium":return"bg-yellow-100 text-yellow-800";case"low":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},v=a=>{switch(a){case"high":return s("High");case"medium":return s("Medium");case"low":return s("Low");default:return s("Normal")}};return e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:s("Waiting Room")}),e.jsx("button",{onClick:o,className:"px-3 py-1 bg-blue-100 text-blue-700 text-sm rounded-md hover:bg-blue-200 transition-colors",children:s("Refresh")})]}),p&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md",children:e.jsx("p",{className:"text-sm text-red-800",children:p})}),e.jsx("div",{className:"space-y-4",children:r.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("p",{className:"text-gray-500 text-lg font-medium",children:s("No patients waiting")}),e.jsx("p",{className:"text-gray-400 text-sm mt-2",children:s("Patients will appear here when they request consultations")})]}):r.map(a=>e.jsx("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:a.patientName}),e.jsxs("p",{className:"text-sm text-gray-600",children:[s("Visit ID"),": ",a.id.slice(-8)]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsxs("span",{className:"text-gray-600",children:[s("Type"),":"]}),e.jsx("span",{className:"ml-2 text-gray-900 capitalize",children:a.type||s("Consultation")})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-gray-600",children:[s("Priority"),":"]}),e.jsx("span",{className:`ml-2 px-2 py-1 text-xs font-medium rounded-full ${f(a.priority)}`,children:v(a.priority)})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-gray-600",children:[s("Requested"),":"]}),e.jsx("span",{className:"ml-2 text-gray-900",children:c(a.createdAt)})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-gray-600",children:[s("Status"),":"]}),e.jsx("span",{className:"ml-2 text-gray-900 capitalize",children:a.status})]})]}),a.symptoms&&a.symptoms.length>0&&e.jsxs("div",{className:"mt-3",children:[e.jsxs("span",{className:"text-gray-600 text-sm",children:[s("Symptoms"),":"]}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:a.symptoms.map((g,N)=>e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:g},N))})]}),a.notes&&e.jsxs("div",{className:"mt-3",children:[e.jsxs("span",{className:"text-gray-600 text-sm",children:[s("Notes"),":"]}),e.jsx("p",{className:"text-sm text-gray-900 mt-1",children:a.notes})]})]}),e.jsxs("div",{className:"flex flex-col items-end space-y-2",children:[e.jsx("button",{onClick:()=>b(a),className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition-colors",children:s("Attend")}),e.jsx("div",{className:"text-right",children:e.jsxs("p",{className:"text-xs text-gray-500",children:[s("Room"),": ",a.roomId?.slice(-8)||"N/A"]})})]})]})},a.id))}),r.length>0&&e.jsx("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-gray-600",children:[s("Total waiting"),": ",r.length]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("span",{className:"text-gray-600",children:[s("High priority"),": ",r.filter(a=>a.priority==="high").length]}),e.jsxs("span",{className:"text-gray-600",children:[s("Normal priority"),": ",r.filter(a=>a.priority==="normal").length]})]})]})})]})}function $(){const[h,r]=i.useState(null),[n,m]=i.useState({totalPatients:0,todayPatients:0,monthlyPatients:0,totalVisits:0,completedVisits:0,pendingVisits:0,averageRating:0,totalHours:0}),[d,p]=i.useState(!0);i.useEffect(()=>{const o=L();o&&(r(o),j(o.id)),p(!1)},[]);const j=o=>{try{const c=JSON.parse(localStorage.getItem("visits")||"[]").filter(t=>t.doctorId===o),v=JSON.parse(localStorage.getItem("patients")||"[]").filter(t=>t.assignedDoctorId===o||c.some(w=>w.patientId===t.id)),a=new Date,g=new Date(a.getFullYear(),a.getMonth(),a.getDate()),N=new Date(a.getFullYear(),a.getMonth(),1),x=c.filter(t=>new Date(t.createdAt)>=g),S=c.filter(t=>new Date(t.createdAt)>=N),y=c.filter(t=>t.status==="completed"),P=c.filter(t=>t.status==="waiting"||t.status==="in_progress"),k=4.5+Math.random()*.5,C=y.length*.5;m({totalPatients:v.length,todayPatients:x.length,monthlyPatients:S.length,totalVisits:c.length,completedVisits:y.length,pendingVisits:P.length,averageRating:k,totalHours:C})}catch(b){console.error("Error loading doctor stats:",b)}};return d?e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-md",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/4 mb-4"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"h-3 bg-gray-200 rounded"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-5/6"})]})]})}):e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:s("Doctor Statistics")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsx("div",{className:"bg-blue-50 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:s("Total Patients")}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:n.totalPatients})]})]})}),e.jsx("div",{className:"bg-green-50 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:s("Completed Visits")}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:n.completedVisits})]})]})}),e.jsx("div",{className:"bg-yellow-50 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-8 h-8 bg-yellow-100 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:s("Pending Visits")}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:n.pendingVisits})]})]})}),e.jsx("div",{className:"bg-purple-50 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"})})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:s("Average Rating")}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:n.averageRating.toFixed(1)})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-3",children:s("Today's Performance")}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-gray-600",children:[s("Patients seen"),":"]}),e.jsx("span",{className:"font-medium",children:n.todayPatients})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-gray-600",children:[s("Hours worked"),":"]}),e.jsxs("span",{className:"font-medium",children:[n.totalHours.toFixed(1),"h"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-gray-600",children:[s("Efficiency"),":"]}),e.jsxs("span",{className:"font-medium",children:[n.todayPatients>0?Math.round(n.completedVisits/n.totalVisits*100):0,"%"]})]})]})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-3",children:s("Monthly Overview")}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-gray-600",children:[s("Total visits"),":"]}),e.jsx("span",{className:"font-medium",children:n.monthlyPatients})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-gray-600",children:[s("Completion rate"),":"]}),e.jsxs("span",{className:"font-medium",children:[n.totalVisits>0?Math.round(n.completedVisits/n.totalVisits*100):0,"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-gray-600",children:[s("Average per day"),":"]}),e.jsx("span",{className:"font-medium",children:Math.round(n.monthlyPatients/30)})]})]})]})]}),e.jsxs("div",{className:"mt-6 bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-3",children:s("Performance Trend")}),e.jsx("div",{className:"h-32 bg-white rounded border-2 border-dashed border-gray-300 flex items-center justify-center",children:e.jsx("p",{className:"text-gray-500 text-sm",children:s("Performance chart would be displayed here")})})]}),e.jsxs("div",{className:"mt-6 flex space-x-3",children:[e.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:s("View Detailed Report")}),e.jsx("button",{className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 transition-colors",children:s("Export Data")})]})]})}function J({onSelectPatient:h,onStartConsultation:r}){const[n,m]=i.useState([]),[d,p]=i.useState(""),[j,o]=i.useState(""),[b,c]=i.useState(!1),[f,v]=i.useState("");i.useEffect(()=>{a()},[]);const a=()=>{try{const t=E();m(t)}catch(t){console.error("Error loading patients:",t),v("Failed to load patients")}},g=t=>{p(t.target.value)},N=t=>{o(t.target.value)},x=t=>{h&&h(t)},S=t=>{r&&r(t)},y=n.filter(t=>{const w=t.name.toLowerCase().includes(d.toLowerCase())||t.village.toLowerCase().includes(d.toLowerCase())||t.phone.includes(d),l=!j||t.ownerRole===j;return w&&l}),P=[...new Set(n.map(t=>t.ownerRole))],k=t=>{switch(t){case"user":return s("Self-registered");case"asha":return s("ASHA Worker");case"doctor":return s("Doctor");default:return t}},C=t=>{switch(t){case"user":return"bg-blue-100 text-blue-800";case"asha":return"bg-purple-100 text-purple-800";case"doctor":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}};return e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:s("All Patients")}),e.jsx("button",{onClick:a,className:"px-3 py-1 bg-blue-100 text-blue-700 text-sm rounded-md hover:bg-blue-200 transition-colors",children:s("Refresh")})]}),f&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md",children:e.jsx("p",{className:"text-sm text-red-800",children:f})}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:s("Search Patients")}),e.jsx("input",{type:"text",value:d,onChange:g,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:s("Enter patient name, village, or phone number")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:s("Registered By")}),e.jsxs("select",{value:j,onChange:N,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:s("All Patients")}),P.map(t=>e.jsx("option",{value:t,children:k(t)},t))]})]})]}),e.jsx("div",{className:"space-y-4",children:y.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),e.jsx("p",{className:"text-gray-500 text-lg font-medium",children:s("No patients found")}),e.jsx("p",{className:"text-gray-400 text-sm mt-2",children:s("Try adjusting your search terms or filters")})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:y.map(t=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:t.photo?e.jsx("img",{src:t.photo,alt:t.name,className:"w-full h-full object-cover rounded-full"}):e.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:t.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:[t.age," ",s("years")," â€¢ ",t.gender]})]})]}),e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${C(t.ownerRole)}`,children:k(t.ownerRole)})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsxs("span",{className:"text-gray-600",children:[s("Village"),":"]}),e.jsx("span",{className:"ml-2 text-gray-900",children:t.village})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-gray-600",children:[s("Phone"),":"]}),e.jsx("span",{className:"ml-2 text-gray-900",children:t.phone})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-gray-600",children:[s("Registered"),":"]}),e.jsx("span",{className:"ml-2 text-gray-900",children:new Date(t.createdAt).toLocaleDateString()})]})]}),t.notes&&e.jsxs("div",{className:"mt-3",children:[e.jsxs("span",{className:"text-gray-600 text-sm",children:[s("Notes"),":"]}),e.jsx("p",{className:"text-sm text-gray-900 mt-1",children:t.notes})]}),e.jsxs("div",{className:"flex space-x-2 mt-4",children:[e.jsx("button",{onClick:()=>x(t),className:"flex-1 px-3 py-2 bg-blue-100 text-blue-700 text-sm rounded-md hover:bg-blue-200 transition-colors",children:s("View Profile")}),e.jsx("button",{onClick:()=>S(t),className:"flex-1 px-3 py-2 bg-green-100 text-green-700 text-sm rounded-md hover:bg-green-200 transition-colors",children:s("Start Consult")})]})]},t.id))})}),y.length>0&&e.jsx("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-gray-600",children:[s("Showing")," ",y.length," ",s("of")," ",n.length," ",s("patients")]}),e.jsx("div",{className:"flex space-x-4",children:P.map(t=>e.jsxs("span",{className:"text-gray-600",children:[k(t),": ",n.filter(w=>w.ownerRole===t).length]},t))})]})})]})}function q(){const h=R(),[r,n]=i.useState(null),[m,d]=i.useState("home"),[p,j]=i.useState([]),[o,b]=i.useState([]),[c,f]=i.useState(null),[v,a]=i.useState(null),[g,N]=i.useState(""),[x,S]=i.useState(!0);i.useEffect(()=>{const l=L();if(!l||l.role!=="doctor"){h("/doctor/login");return}n(l),y(),S(!1)},[h]);const y=()=>{try{const l=E();j(l);const u=D();b(u)}catch(l){console.error("Error loading doctor data:",l)}},P=()=>{z(),h("/")},k=l=>{try{if(W(l.id,{status:"in_progress",doctorId:r.id,attendedAt:new Date().toISOString()})){b(M=>M.filter(A=>A.id!==l.id));const V=p.find(M=>M.id===l.patientId);V&&(f(V),d("chat"))}}catch(u){console.error("Error attending patient:",u),alert("Failed to attend patient")}},C=(l,u)=>{try{if(!u.trim()){alert("Please enter prescription details");return}const V={patientId:l,doctorId:r.id,doctorName:r.name,text:u.trim(),createdAt:new Date().toISOString()};I(V);const M={doctorId:r.id,doctorName:r.name,text:u.trim(),pharmacyId:"default-pharmacy",createdAt:new Date().toISOString()};H(M,l),O(r.id,{attendedCount:1}),alert("Visit completed and prescription added successfully!"),f(null),d("home")}catch(V){console.error("Error completing visit:",V),alert("Failed to complete visit")}},t=l=>{const u=`doctor_consult_${l.id}_${Date.now()}`;a(u),N(l.name)},w=()=>{a(null),N("")};return x?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:s("Loading dashboard...")})]})}):r?e.jsx("div",{className:"flex flex-col h-screen bg-gray-100",children:e.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[e.jsxs("div",{className:"w-64 bg-white shadow-xl flex flex-col",children:[e.jsx("nav",{className:"flex-1 p-4 space-y-2",children:[{key:"home",label:s("Home"),icon:"ðŸ "},{key:"patients",label:s("Patients"),icon:"ðŸ‘¥"},{key:"waiting",label:s("Waiting Room"),icon:"â³"},{key:"chat",label:s("Chat / Video"),icon:"ðŸ’¬"},{key:"prescriptions",label:s("Prescriptions"),icon:"ðŸ’Š"},{key:"stats",label:s("Statistics"),icon:"ðŸ“Š"},{key:"profile",label:s("Profile"),icon:"ðŸ‘¤"}].map(l=>e.jsxs("button",{onClick:()=>d(l.key),className:`w-full text-left px-4 py-3 rounded-lg font-medium transition-colors ${m===l.key?"bg-green-600 text-white shadow-md":"hover:bg-green-100 text-gray-700"}`,children:[e.jsx("span",{className:"mr-3",children:l.icon}),l.label]},l.key))}),e.jsx("div",{className:"p-4 border-t",children:e.jsxs("button",{onClick:P,className:"w-full text-left px-4 py-3 rounded-lg font-medium bg-red-500 text-white hover:bg-red-600 transition-colors",children:[e.jsx("span",{className:"mr-3",children:"ðŸšª"}),s("Logout")]})})]}),e.jsx("div",{className:"flex-1 flex justify-center items-start p-6 overflow-y-auto",children:e.jsxs("div",{className:"w-full max-w-6xl",children:[v&&e.jsxs("div",{className:"mb-6 bg-white p-4 rounded-xl shadow",children:[e.jsxs("h3",{className:"font-semibold mb-2",children:[s("Video Call with")," ",g]}),e.jsx(T,{roomName:v,displayName:r.name,onEnd:w}),e.jsx("button",{className:"mt-3 bg-red-600 text-white px-4 py-2 rounded hover:bg-red-500 transition-colors",onClick:w,children:s("End Call")})]}),m==="home"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white shadow-lg rounded-2xl p-8 text-center",children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:[s("Welcome"),", ",s("Dr.")," ",r.name," ðŸ‘©â€âš•ï¸"]}),e.jsx("p",{className:"text-gray-600 mb-6",children:s("Manage your patients and provide telemedicine services")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mt-6",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:p.length}),e.jsx("div",{className:"text-sm text-gray-600",children:s("Total Patients")})]}),e.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:o.length}),e.jsx("div",{className:"text-sm text-gray-600",children:s("Waiting")})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:r.specialization||"N/A"}),e.jsx("div",{className:"text-sm text-gray-600",children:s("Specialization")})]}),e.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:r.licenseNumber||"N/A"}),e.jsx("div",{className:"text-sm text-gray-600",children:s("License")})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs("button",{onClick:()=>d("waiting"),className:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow text-left",children:[e.jsx("div",{className:"text-3xl mb-3",children:"â³"}),e.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:s("Waiting Room")}),e.jsx("p",{className:"text-gray-600 text-sm",children:s("Attend waiting patients")})]}),e.jsxs("button",{onClick:()=>d("patients"),className:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow text-left",children:[e.jsx("div",{className:"text-3xl mb-3",children:"ðŸ‘¥"}),e.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:s("All Patients")}),e.jsx("p",{className:"text-gray-600 text-sm",children:s("View and manage all patients")})]}),e.jsxs("button",{onClick:()=>d("stats"),className:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow text-left",children:[e.jsx("div",{className:"text-3xl mb-3",children:"ðŸ“Š"}),e.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:s("Statistics")}),e.jsx("p",{className:"text-gray-600 text-sm",children:s("View your performance metrics")})]})]})]}),m==="patients"&&e.jsx(J,{onSelectPatient:f,onStartConsultation:t}),m==="waiting"&&e.jsx(F,{onAttendPatient:k}),m==="chat"&&e.jsx("div",{className:"space-y-6",children:c?e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:[s("Consultation with")," ",c.name]}),e.jsx(B,{userId:c.id,userName:c.name,messages:[],onSendMessage:()=>{}}),e.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-gray-800 mb-2",children:s("Complete Visit")}),e.jsx("textarea",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",rows:"4",placeholder:s("Enter prescription details..."),id:"prescription-text"}),e.jsx("button",{onClick:()=>{const l=document.getElementById("prescription-text").value;C(c.id,l)},className:"mt-3 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition-colors",children:s("Complete Visit")})]})]}):e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-md text-center",children:e.jsx("p",{className:"text-gray-500",children:s("Select a patient from the waiting room or patients list to start consultation")})})}),m==="prescriptions"&&e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:s("Prescriptions")}),e.jsx("p",{className:"text-gray-500 text-center py-8",children:s("Prescriptions will appear here after completing patient visits")})]}),m==="stats"&&e.jsx($,{}),m==="profile"&&e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:s("Profile")}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:s("Name")}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:r.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:s("Specialization")}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:r.specialization||s("Not specified")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:s("Phone")}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:r.phone})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:s("Email")}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:r.email||s("Not specified")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:s("Location")}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:r.location||s("Not specified")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:s("License Number")}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:r.licenseNumber||s("Not specified")})]})]})]})]})})]})}):null}export{q as default};
